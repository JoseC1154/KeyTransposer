<!-- FILE: index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
  <meta name="theme-color" content="#121212" />
  <title>Piano Chord Transposer</title>

  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css" />

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
</head>
<body>

  <!-- ===== TOP BAR ===== -->
  <header class="topbar" id="topbar">
  <div class="leftGroup">
    <button class="ghost" id="btnMenu" type="button" aria-haspopup="dialog" aria-controls="menuModal" aria-label="Menu">☰</button>
    <div class="brand">
      <span class="dot"></span>
      <div class="titles">
        <div class="appname">Piano Chord Transposer</div>
        <div class="subtitle" id="chordNameText">Chord: —</div>
      </div>
    </div>
  </div>
  <button class="ghost" id="btnClear" type="button">Clear</button>
</header>

  <main class="wrap">

    <!-- ===== PIANO ===== -->
    <section class="pianoCard" aria-label="Piano">
      <div class="pianoScroll" id="pianoScroll">
        <div class="piano" id="piano" role="application" aria-label="Interactive piano"></div>
      </div>
    </section>
    <!-- ===== CHORD MEMORY (12 slots) ===== -->
    <section class="memoryCard" id="memoryCard" aria-label="Chord memory">
      <div class="memoryHead">
        <div class="memoryTitle">Chord Memory</div>
        <div class="memoryMeta" id="memoryMeta">Mode: Free</div>
        <div class="bankSelector" id="bankSelector">
          <button class="bankBtn" id="btnBankPrev" type="button" aria-label="Previous scale">◀</button>
          <button class="bankBtn bankCurrent" id="btnBankCurrent" type="button" aria-label="Current scale">C</button>
          <button class="bankBtn" id="btnBankNext" type="button" aria-label="Next scale">▶</button>
        </div>
        <button class="ghost" id="btnMemory" type="button" aria-haspopup="dialog" aria-controls="memoryModal">Manage</button>
      </div>
      <div class="memoryGrid" id="memoryGrid" role="group" aria-label="12 chord memory slots">
        <button class="memBtn" type="button" data-slot="0" aria-label="Memory slot 1">1</button>
        <button class="memBtn" type="button" data-slot="1" aria-label="Memory slot 2">2</button>
        <button class="memBtn" type="button" data-slot="2" aria-label="Memory slot 3">3</button>
        <button class="memBtn" type="button" data-slot="3" aria-label="Memory slot 4">4</button>
        <button class="memBtn" type="button" data-slot="4" aria-label="Memory slot 5">5</button>
        <button class="memBtn" type="button" data-slot="5" aria-label="Memory slot 6">6</button>
        <button class="memBtn" type="button" data-slot="6" aria-label="Memory slot 7">7</button>
        <button class="memBtn" type="button" data-slot="7" aria-label="Memory slot 8">8</button>
        <button class="memBtn" type="button" data-slot="8" aria-label="Memory slot 9">9</button>
        <button class="memBtn" type="button" data-slot="9" aria-label="Memory slot 10">10</button>
        <button class="memBtn" type="button" data-slot="10" aria-label="Memory slot 11">11</button>
        <button class="memBtn" type="button" data-slot="11" aria-label="Memory slot 12">12</button>
      </div>
    </section>

    <!-- ===== SINGLE-LINE CONTROL BAR (NO SCROLL ON MOBILE) ===== -->
    <section class="controlBar" id="controls" aria-label="Controls">
      <button class="ctrl mini" id="btnMinus" type="button" aria-label="Remove octave">−</button>
      <button class="ctrl mini" id="btnPlus" type="button" aria-label="Add octave">+</button>

      <div class="hud">
        <div class="hudRow">
          <span class="hudLabel">Oct:</span>
          <span class="hudValue" id="octaveText">—</span>
        </div>
        <div class="hudRow">
          <span class="hudLabel">Sel:</span>
          <span class="hudValue" id="transposeHint">Select keys</span>
        </div>
      </div>

      <button class="ctrl mini accent" id="btnDown" type="button" aria-label="Transpose down">▼</button>
      <button class="ctrl mini accent" id="btnUp" type="button" aria-label="Transpose up">▲</button>
      <button class="ctrl mini" id="btnAlternates" type="button" aria-label="Alternate chords">≈</button>
    </section>

    <footer class="footer" id="footer">
      <span id="status">Offline-ready.</span>
    </footer>

  </main>
  <!-- ===== MENU MODAL ===== -->
  <div class="modal" id="menuModal" hidden>
    <div class="modalOverlay" data-close="menuModal"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="menuTitle">
      $1
      <div class="modalSection">
        <div class="modalLabel">How to use</div>
        <button class="ghost" type="button" id="btnHowTo">How to use the app</button>
        <div class="modalHint">Quick help and tips. You can disable the first-run popup inside the guide.</div>
      </div>

$2
        <div class="modeRow" role="group" aria-label="App mode">
          <button class="modeBtn" type="button" id="modeFree" data-mode="free">Free Transpose</button>
          <button class="modeBtn" type="button" id="modeChordScale" data-mode="chordScale">Chord → Scale</button>
        </div>
        <div class="modalHint" id="modeHint">Free Transpose: select any notes and transpose by semitones.</div>
      </div>

      <div class="modalSection">
        <div class="modalLabel">Scale</div>
        <button class="ghost" type="button" id="btnPickScale">Pick / Manage Scales</button>
        <div class="modalHint" id="scaleHint">Used for chord memory in Chord → Scale mode.</div>
      </div>

      <div class="modalSection">
        <div class="modalLabel">Chord Memory</div>
        <button class="ghost" type="button" id="btnOpenMemory">Open Memory Manager</button>
        <div class="modalHint">Store up to 12 chords with their scale. Slots update when you transpose.</div>
      </div>
    </div>
  </div>

  <!-- ===== MEMORY MODAL ===== -->
  <div class="modal" id="memoryModal" hidden>
    <div class="modalOverlay" data-close="memoryModal"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="memoryTitle">
      <div class="modalHead">
        <div class="modalTitle" id="memoryTitle">Chord Memory</div>
        <button class="ghost" type="button" data-close="memoryModal" aria-label="Close">✕</button>
      </div>

      <div class="modalSection">
        <div class="modalLabel">Save chord</div>
        <div class="modalHint">Select notes on the keyboard, choose a scale, then tap a slot.</div>
        <div class="memoryGrid" id="memoryGridModal" role="group" aria-label="Memory slots (modal)"></div>
      </div>

      <div class="modalSection">
        <div class="modalLabel">Scale</div>
        <div class="scalePickerRow">
          <select id="scaleSelect" aria-label="Select scale"></select>
          <button class="ghost" type="button" id="btnScaleAdd">Add</button>
          <!-- Scale banks are fixed (12 keys). Removing scales is disabled. -->
        </div>
        <div class="modalHint" id="scaleListHint">Scales save locally on this device.</div>
      </div>

      <div class="modalSection">
        <div class="modalLabel">Slot actions</div>
        <div class="actionRow">
          <button class="ghost" type="button" id="btnSlotLoad">Load</button>
          <button class="ghost" type="button" id="btnSlotClear">Clear</button>
        </div>
        <div class="modalHint" id="slotHint">Load a chord to practice it, then transpose to move it through keys.</div>
      </div>
    </div>
  </div>

  <!-- ===== CUSTOM PROMPT MODAL ===== -->
  <div class="modal" id="promptModal" hidden>
    <div class="modalOverlay" data-close="promptModal"></div>
    <div class="modalCard promptCard" role="dialog" aria-modal="true" aria-labelledby="promptTitle">
      <div class="modalHead">
        <div class="modalTitle" id="promptTitle">Name this chord</div>
        <button class="ghost" type="button" data-close="promptModal" aria-label="Close">✕</button>
      </div>
      <div class="modalSection">
        <input type="text" id="promptInput" class="promptInput" placeholder="Enter chord name" />
      </div>
      <div class="modalSection promptActions">
        <button class="ghost" type="button" data-close="promptModal">Cancel</button>
        <button class="ghost accent" type="button" id="promptOk">OK</button>
      </div>
    </div>
  </div>

  <!-- ===== ALTERNATE CHORDS MODAL ===== -->
  <div class="modal" id="alternatesModal" hidden>
    <div class="modalOverlay" data-close="alternatesModal"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="alternatesTitle">
      <div class="modalHead">
        <div class="modalTitle" id="alternatesTitle">Alternate Chord Suggestions</div>
        <button class="ghost" type="button" data-close="alternatesModal" aria-label="Close">✕</button>
      </div>
      <div class="modalSection">
        <div class="modalHint" id="alternatesHint">Similar chords and voicings you can try:</div>
        <div id="alternatesList" class="alternatesList"></div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
